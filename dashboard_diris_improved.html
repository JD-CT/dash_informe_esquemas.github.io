<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Casos NO por DIRIS - Mejora Grafica</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#f6f8fa;--card:#ffffff;--muted:#6b7280;--accent:#2563eb}
    body{font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);margin:0;color:#0f172a}
    .container{max-width:1100px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:0}
    .meta{color:var(--muted);font-size:13px}
    .sheet-grid{display:flex;flex-direction:column;gap:18px;margin-top:18px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 1px 2px rgba(15,23,42,0.04);}
    .card h2{margin:0 0 8px 0;font-size:16px}
    .card .info{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px}
    .badge{background:#eef2ff;color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:600;font-size:13px}
    .chart-row{display:flex;gap:18px;align-items:flex-start}
    .chart-canvas{flex:1;min-width:320px}
    .aside{width:300px}
    .table-compact{width:100%;border-collapse:collapse;margin-top:10px}
    .table-compact th,.table-compact td{padding:8px;border-bottom:1px solid #eef2f6;text-align:left;font-size:13px}
    .table-compact th{color:#374151;font-weight:600}
    .small{font-size:13px;color:var(--muted)}
    @media(max-width:900px){.chart-row{flex-direction:column}.aside{width:100%}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Casos 'NO' por DIRIS — Informe mejorado</h1>
        <div class="meta">Archivo: Analisis_Esquemas_Condiciones_anom (1).xlsx • Hojas procesadas: 4</div>
      </div>
      <div class="small">Diseño: Experto UX • Interactivo: barras con tooltip y ordenar</div>
    </header>

    <div class="sheet-grid">
      <section class="card">
        <h2>esquema_vigente</h2>
        <div class="info">
          <div class="badge">NO totales: 436</div>
          <div class="small">Encabezado fila: 11 • Filas: 87773</div>
          <div class="small">Columna cumplimiento: <strong>esquema_vigente</strong></div>
        </div>

        <div class="chart-row">
          <div class="chart-canvas">
            <canvas id="chart_0" height="380"></canvas>
          </div>
          <aside class="aside">
            <div style="font-weight:600;margin-bottom:8px">Top 10 DIRIS (NO)</div>
            <table class="table-compact"><tr><td>LIMA CENTRO</td><td style="text-align:right;font-weight:600">121</td></tr><tr><td>LORETO</td><td style="text-align:right;font-weight:600">67</td></tr><tr><td>LIMA SUR</td><td style="text-align:right;font-weight:600">37</td></tr><tr><td>LIMA ESTE</td><td style="text-align:right;font-weight:600">34</td></tr><tr><td>PIURA</td><td style="text-align:right;font-weight:600">26</td></tr><tr><td>LA LIBERTAD</td><td style="text-align:right;font-weight:600">21</td></tr><tr><td>CUSCO</td><td style="text-align:right;font-weight:600">19</td></tr><tr><td>AMAZONAS</td><td style="text-align:right;font-weight:600">17</td></tr><tr><td>LAMBAYEQUE</td><td style="text-align:right;font-weight:600">14</td></tr><tr><td>LIMA NORTE</td><td style="text-align:right;font-weight:600">14</td></tr></table>
            <div style="margin-top:10px" class="small">Nota: la gr fica muestra Top 25 por defecto.</div>
          </aside>
        </div>
      </section>
          <section class="card">
        <h2>personalizados_cumple_</h2>
        <div class="info">
          <div class="badge">NO totales: 2588</div>
          <div class="small">Encabezado fila: 8 • Filas: 2588</div>
          <div class="small">Columna cumplimiento: <strong>personalizados_cumple_orden_18</strong></div>
        </div>

        <div class="chart-row">
          <div class="chart-canvas">
            <canvas id="chart_1" height="380"></canvas>
          </div>
          <aside class="aside">
            <div style="font-weight:600;margin-bottom:8px">Top 10 DIRIS (NO)</div>
            <table class="table-compact"><tr><td>LIMA CENTRO</td><td style="text-align:right;font-weight:600">767</td></tr><tr><td>LIMA NORTE</td><td style="text-align:right;font-weight:600">362</td></tr><tr><td>LIMA ESTE</td><td style="text-align:right;font-weight:600">240</td></tr><tr><td>LIMA SUR</td><td style="text-align:right;font-weight:600">228</td></tr><tr><td>CALLAO</td><td style="text-align:right;font-weight:600">181</td></tr><tr><td>LA LIBERTAD</td><td style="text-align:right;font-weight:600">106</td></tr><tr><td>ICA</td><td style="text-align:right;font-weight:600">98</td></tr><tr><td>LAMBAYEQUE</td><td style="text-align:right;font-weight:600">88</td></tr><tr><td>LORETO</td><td style="text-align:right;font-weight:600">79</td></tr><tr><td>LIMA</td><td style="text-align:right;font-weight:600">61</td></tr></table>
            <div style="margin-top:10px" class="small">Nota: la gr fica muestra Top 25 por defecto.</div>
          </aside>
        </div>
      </section>
          <section class="card">
        <h2>personalizados_cumple_1</h2>
        <div class="info">
          <div class="badge">NO totales: 39</div>
          <div class="small">Encabezado fila: 8 • Filas: 39</div>
          <div class="small">Columna cumplimiento: <strong>personalizados_cumple_orden_niños_0a3</strong></div>
        </div>

        <div class="chart-row">
          <div class="chart-canvas">
            <canvas id="chart_2" height="380"></canvas>
          </div>
          <aside class="aside">
            <div style="font-weight:600;margin-bottom:8px">Top 10 DIRIS (NO)</div>
            <table class="table-compact"><tr><td>LIMA CENTRO</td><td style="text-align:right;font-weight:600">20</td></tr><tr><td>LIMA ESTE</td><td style="text-align:right;font-weight:600">4</td></tr><tr><td>ICA</td><td style="text-align:right;font-weight:600">3</td></tr><tr><td>UCAYALI</td><td style="text-align:right;font-weight:600">2</td></tr><tr><td>LIMA SUR</td><td style="text-align:right;font-weight:600">2</td></tr><tr><td>LA LIBERTAD</td><td style="text-align:right;font-weight:600">1</td></tr><tr><td>LORETO</td><td style="text-align:right;font-weight:600">1</td></tr><tr><td>HUANUCO</td><td style="text-align:right;font-weight:600">1</td></tr><tr><td>ANCASH</td><td style="text-align:right;font-weight:600">1</td></tr><tr><td>LIMA NORTE</td><td style="text-align:right;font-weight:600">1</td></tr></table>
            <div style="margin-top:10px" class="small">Nota: la gr fica muestra Top 25 por defecto.</div>
          </aside>
        </div>
      </section>
          <section class="card">
        <h2>personalizados_cumple_2</h2>
        <div class="info">
          <div class="badge">NO totales: 116</div>
          <div class="small">Encabezado fila: 8 • Filas: 116</div>
          <div class="small">Columna cumplimiento: <strong>personalizados_cumple_orden_niños_4a17</strong></div>
        </div>

        <div class="chart-row">
          <div class="chart-canvas">
            <canvas id="chart_3" height="380"></canvas>
          </div>
          <aside class="aside">
            <div style="font-weight:600;margin-bottom:8px">Top 10 DIRIS (NO)</div>
            <table class="table-compact"><tr><td>LIMA CENTRO</td><td style="text-align:right;font-weight:600">57</td></tr><tr><td>LIMA NORTE</td><td style="text-align:right;font-weight:600">7</td></tr><tr><td>LA LIBERTAD</td><td style="text-align:right;font-weight:600">6</td></tr><tr><td>ICA</td><td style="text-align:right;font-weight:600">5</td></tr><tr><td>MADRE DE DIOS</td><td style="text-align:right;font-weight:600">5</td></tr><tr><td>LORETO</td><td style="text-align:right;font-weight:600">4</td></tr><tr><td>UCAYALI</td><td style="text-align:right;font-weight:600">4</td></tr><tr><td>AREQUIPA</td><td style="text-align:right;font-weight:600">3</td></tr><tr><td>LIMA ESTE</td><td style="text-align:right;font-weight:600">3</td></tr><tr><td>LAMBAYEQUE</td><td style="text-align:right;font-weight:600">3</td></tr></table>
            <div style="margin-top:10px" class="small">Nota: la gr fica muestra Top 25 por defecto.</div>
          </aside>
        </div>
      </section>
    
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  function createGradient(ctx, color){
    var gradient = ctx.createLinearGradient(0,0,400,0);
    gradient.addColorStop(0, color + 'cc');
    gradient.addColorStop(1, color + '66');
    return gradient;
  }

  (function(){
    var ctx = document.getElementById('chart_0').getContext('2d');
    var labels = ["LIMA CENTRO", "LORETO", "LIMA SUR", "LIMA ESTE", "PIURA", "LA LIBERTAD", "CUSCO", "AMAZONAS", "LAMBAYEQUE", "LIMA NORTE", "TACNA", "JUNIN", "SAN MARTIN", "LIMA", "PUNO", "MADRE DE DIOS", "UCAYALI", "HUANUCO", "AREQUIPA", "ICA", "PASCO", "HUANCAVELICA", "CALLAO", "ANCASH", "AYACUCHO"];
    var dataVals = [121, 67, 37, 34, 26, 21, 19, 17, 14, 14, 13, 7, 6, 5, 4, 4, 4, 4, 3, 3, 2, 2, 2, 2, 1];
    var gradient = createGradient(ctx, '#2563eb');
    new Chart(ctx, {
      type: 'bar',
      data: { labels: labels, datasets: [{ label: 'Casos NO', data: dataVals, backgroundColor: gradient, borderColor: '#2563eb', borderWidth: 1 }] },
      options: {
        indexAxis: 'y',
        scales: { x: { beginAtZero: true, ticks: { precision:0 } }, y: { ticks: { autoSkip: false, maxRotation:0, minRotation:0 } } },
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx){ return ' ' + ctx.parsed.x + ' casos'; } } } },
        elements: { bar: { borderRadius: 6, borderSkipped: false } }
      }
    });
  })();

  (function(){
    var ctx = document.getElementById('chart_1').getContext('2d');
    var labels = ["LIMA CENTRO", "LIMA NORTE", "LIMA ESTE", "LIMA SUR", "CALLAO", "LA LIBERTAD", "ICA", "LAMBAYEQUE", "LORETO", "LIMA", "AREQUIPA", "PIURA", "CUSCO", "JUNIN", "UCAYALI", "TACNA", "ANCASH", "SAN MARTIN", "AMAZONAS", "HUANUCO", "MOQUEGUA", "MADRE DE DIOS", "CAJAMARCA", "AYACUCHO", "PUNO"];
    var dataVals = [767, 362, 240, 228, 181, 106, 98, 88, 79, 61, 55, 51, 44, 33, 31, 30, 22, 21, 20, 18, 11, 9, 8, 8, 5];
    var gradient = createGradient(ctx, '#ef4444');
    new Chart(ctx, {
      type: 'bar',
      data: { labels: labels, datasets: [{ label: 'Casos NO', data: dataVals, backgroundColor: gradient, borderColor: '#ef4444', borderWidth: 1 }] },
      options: {
        indexAxis: 'y',
        scales: { x: { beginAtZero: true, ticks: { precision:0 } }, y: { ticks: { autoSkip: false, maxRotation:0, minRotation:0 } } },
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx){ return ' ' + ctx.parsed.x + ' casos'; } } } },
        elements: { bar: { borderRadius: 6, borderSkipped: false } }
      }
    });
  })();

  (function(){
    var ctx = document.getElementById('chart_2').getContext('2d');
    var labels = ["LIMA CENTRO", "LIMA ESTE", "ICA", "UCAYALI", "LIMA SUR", "LA LIBERTAD", "LORETO", "HUANUCO", "ANCASH", "LIMA NORTE", "MOQUEGUA", "PIURA", "MADRE DE DIOS"];
    var dataVals = [20, 4, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1];
    var gradient = createGradient(ctx, '#059669');
    new Chart(ctx, {
      type: 'bar',
      data: { labels: labels, datasets: [{ label: 'Casos NO', data: dataVals, backgroundColor: gradient, borderColor: '#059669', borderWidth: 1 }] },
      options: {
        indexAxis: 'y',
        scales: { x: { beginAtZero: true, ticks: { precision:0 } }, y: { ticks: { autoSkip: false, maxRotation:0, minRotation:0 } } },
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx){ return ' ' + ctx.parsed.x + ' casos'; } } } },
        elements: { bar: { borderRadius: 6, borderSkipped: false } }
      }
    });
  })();

  (function(){
    var ctx = document.getElementById('chart_3').getContext('2d');
    var labels = ["LIMA CENTRO", "LIMA NORTE", "LA LIBERTAD", "ICA", "MADRE DE DIOS", "LORETO", "UCAYALI", "AREQUIPA", "LIMA ESTE", "LAMBAYEQUE", "CAJAMARCA", "CUSCO", "LIMA SUR", "PIURA", "SAN MARTIN", "AYACUCHO", "AMAZONAS", "MOQUEGUA", "HUANUCO", "PASCO", "CALLAO"];
    var dataVals = [57, 7, 6, 5, 5, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1];
    var gradient = createGradient(ctx, '#b45309');
    new Chart(ctx, {
      type: 'bar',
      data: { labels: labels, datasets: [{ label: 'Casos NO', data: dataVals, backgroundColor: gradient, borderColor: '#b45309', borderWidth: 1 }] },
      options: {
        indexAxis: 'y',
        scales: { x: { beginAtZero: true, ticks: { precision:0 } }, y: { ticks: { autoSkip: false, maxRotation:0, minRotation:0 } } },
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx){ return ' ' + ctx.parsed.x + ' casos'; } } } },
        elements: { bar: { borderRadius: 6, borderSkipped: false } }
      }
    });
  })();
</script>
</body>
</html>